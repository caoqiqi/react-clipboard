{"version":3,"sources":["../src/clipoboard.js"],"names":["CopyImg","state","visible","componentDidMount","document","addEventListener","handlePaste","componentWillUnmount","removeEventListener","fileLength_base64","v","str","substring","equalIndex","indexOf","strLength","length","fileLength","parseInt","handleOk","e","imgReader","item","blob","getAsFile","reader","FileReader","imgObj","onload","display","height","width","target","result","setState","img","readAsDataURL","clipboardData","i","items","types","kind","type","match","props","border","borderRadius","textAlign","lineHeight","Component"],"mappings":"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","file":"clipoboard.js","sourcesContent":["import React from 'react';\n\nexport default class CopyImg extends React.Component {\n    constructor () {\n        super();\n        this.state = {\n            visible: false\n        };\n        this.componentDidMount = () => {\n            document.addEventListener( 'paste', this.handlePaste);\n        };\n        this.componentWillUnmount = () => {\n            document.removeEventListener('paste', this.handlePaste);\n        };\n\n        this.fileLength_base64 = (v) => {\n                let str = v.substring(22);\n                let equalIndex= str.indexOf('=');\n                if(str.indexOf('=')>0)\n                {\n                    str=str.substring(0, equalIndex);\n                }\n                let strLength=str.length;\n                let fileLength=parseInt(strLength-(strLength/8)*2);\n                return fileLength;\n        }\n        this.handleOk = () => {\n            // if(!this.state.result) {\n            //     message.warning('请先粘贴图片');\n            // }\n            // else {\n            //     const fileLength = this.fileLength_base64(this.state.result);\n            //     const isLt2M = fileLength / 1024 / 1024 < 2;\n            //     if (!isLt2M) {\n            //         message.error('图片必须小于2M!');\n            //     }\n            //     else {\n\n            //         this.setState({\n            //             visible: false\n            //         });\n            //         let xhr = new XMLHttpRequest();\n            //         let fd = new FormData();\n            //         xhr.open('post', '***', true);\n            //         fd.append('file', this.state.result);\n            //         xhr.send(fd);\n            //     }             \n            // }       \n        }\n        this.handlePaste = (e) => {\n            var imgReader = (item) => {\n                var blob = item.getAsFile(),\n                    reader = new FileReader();\n                let imgObj;\n                reader.onload = (e) => {\n                    let imgObj = <img style={{display: 'inline-block', height: '100%', width: '100%'}} src={e.target.result}/>;\n                    this.setState({\n                        img: imgObj,\n                        result: e.target.result\n                    });\n                }\n                reader.readAsDataURL( blob );\n            };\n            var clipboardData = e.clipboardData,\n            i = 0,\n            items, item, types;\n\n            if( clipboardData ){\n                items = clipboardData.items;\n\n                if( !items ){\n                    return;\n                }\n\n                item = items[0];\n                types = clipboardData.types || [];\n\n                for( ; i < types.length; i++ ){\n                    if( types[i] === 'Files' ){\n                        item = items[i];\n                        break;\n                    }\n                }\n\n                if( item && item.kind === 'file' && item.type.match(/^image\\//i) ){\n                    imgReader( item );\n                }\n            }\n        };\n    }\n    render () {\n        return <div\n                  style={{\n                        width: this.props.width ? this.props.width : '300px',\n                        height: this.props.height ? this.props.height :'300px',\n                        border: '1px dotted #ccc',\n                        borderRadius: '4px',\n                        textAlign: 'center',\n                        lineHeight: this.props.height ? this.props.height :'300px'\n                  }}>\n                  {this.state.img ? this.state.img : \"ctrl+v或鼠标右键进行粘贴\"}\n\n            </div>\n    }\n}   "]}